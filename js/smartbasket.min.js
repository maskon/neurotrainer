document.addEventListener("DOMContentLoaded",function(){var b,c,d,f=f||{};f.scope={},f.findInternal=function(b,c,a){b instanceof String&&(b=b+"");for(var d,e=b.length,f=0;f<e;f++)if(d=b[f],c.call(a,d,f,b))return{i:f,v:d};return{i:-1,v:void 0}},f.ASSUME_ES5=!1,f.ASSUME_NO_NATIVE_MAP=!1,f.ASSUME_NO_NATIVE_SET=!1,f.SIMPLE_FROUND_POLYFILL=!1,f.defineProperty=f.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(b,c,a){b!=Array.prototype&&b!=Object.prototype&&(b[c]=a.value)},f.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a},f.global=f.getGlobal(this),f.polyfill=function(b,c,d,g){if(c){for(d=f.global,b=b.split("."),g=0;g<b.length-1;g++){var h=b[g];h in d||(d[h]={}),d=d[h]}(c=c(g=d[b=b[b.length-1]]))!=g&&null!=c&&f.defineProperty(d,b,{configurable:!0,writable:!0,value:c})}},f.polyfill("Array.prototype.find",function(a){return a||function(b,c){return f.findInternal(this,b,c).v}},"es6","es3"),b=function(b){var c=function(d,j,q){var w={invalid:[],getCaret:function(){try{var a=0,b=d.get(0),c=document.selection,e=b.selectionStart;if(c&&-1===navigator.appVersion.indexOf("MSIE 10")){var f=c.createRange();f.moveStart("character",-w.val().length),a=f.text.length}else(e||"0"===e)&&(a=e);return a}catch(a){}},setCaret:function(a){try{if(d.is(":focus")){var b=d.get(0);if(b.setSelectionRange)b.setSelectionRange(a,a);else{var c=b.createTextRange();c.collapse(!0),c.moveEnd("character",a),c.moveStart("character",a),c.select()}}}catch(a){}},events:function(){d.on("keydown.mask",function(a){d.data("mask-keycode",a.keyCode||a.which),d.data("mask-previus-value",d.val()),d.data("mask-previus-caret-pos",w.getCaret()),w.maskDigitPosMapOld=w.maskDigitPosMap}).on(b.jMaskGlobals.useInput?"input.mask":"keyup.mask",w.behaviour).on("paste.mask drop.mask",function(){setTimeout(function(){d.keydown().keyup()},100)}).on("change.mask",function(){d.data("changed",!0)}).on("blur.mask",function(){g===w.val()||d.data("changed")||d.trigger("change"),d.data("changed",!1)}).on("blur.mask",function(){g=w.val()}).on("focus.mask",function(c){!0===q.selectOnFocus&&b(c.target).select()}).on("focusout.mask",function(){q.clearIfNotMatch&&!f.test(w.val())&&w.val("")})},getRegexMask:function(){for(var b,c,d,e,f=[],g=0;g<j.length;g++)(b=r.translation[j.charAt(g)])?(c=b.pattern.toString().replace(/.{1}$|^.{1}/g,""),d=b.optional,(b=b.recursive)?(f.push(j.charAt(g)),e={digit:j.charAt(g),pattern:c}):f.push(d||b?c+"?":c)):f.push(j.charAt(g).replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"));return f=f.join(""),e&&(f=f.replace(new RegExp("("+e.digit+"(.*"+e.digit+")?)"),"($1)?").replace(new RegExp(e.digit,"g"),e.pattern)),new RegExp(f)},destroyEvents:function(){d.off(["input","keydown","keyup","paste","drop","blur","focusout",""].join(".mask "))},val:function(a){var b=d.is("input")?"val":"text";return 0<arguments.length?(d[b]()!==a&&d[b](a),b=d):b=d[b](),b},calculateCaretPosition:function(a){var b=w.getMasked(),f=w.getCaret();if(a!==b){var g=d.data("mask-previus-caret-pos")||0;b=b.length;var h,j=a.length,k=a=0,m=0,o=0;for(h=f;h<b&&w.maskDigitPosMap[h];h++)k++;for(h=f-1;0<=h&&w.maskDigitPosMap[h];h--)a++;for(h=f-1;0<=h;h--)w.maskDigitPosMap[h]&&m++;for(h=g-1;0<=h;h--)w.maskDigitPosMapOld[h]&&o++;f>j?f=10*b:g>=f&&g!==j?w.maskDigitPosMapOld[f]||(g=f,f=f-(o-m)-a,w.maskDigitPosMap[f]&&(f=g)):f>g&&(f=f+(m-o)+k)}return f},behaviour:function(a){a=a||window.event,w.invalid=[];var c=d.data("mask-keycode");if(-1===b.inArray(c,r.byPassKeys)){c=w.getMasked();var f=w.getCaret(),g=d.data("mask-previus-value")||"";return setTimeout(function(){w.setCaret(w.calculateCaretPosition(g))},b.jMaskGlobals.keyStrokeCompensation),w.val(c),w.setCaret(f),w.callbacks(a)}},getMasked:function(e,i){var s,x=[],z=void 0===i?w.val():i+"",l=0,A=j.length,p=0,B=z.length,u=1,C="push",D=-1,E=0;if(i=[],q.reverse){C="unshift",u=-1;var F=0;l=A-1,p=B-1;var G=function(){return-1<l&&-1<p}}else F=A-1,G=function(){return l<A&&p<B};for(;G();){var H=j.charAt(l),h=z.charAt(p),g=r.translation[H];g?(h.match(g.pattern)?(x[C](h),g.recursive&&(-1===D?D=l:l===F&&l!==D&&(l=D-u),F===D&&(l-=u)),l+=u):h===s?(E--,s=void 0):g.optional?(l+=u,p-=u):g.fallback?(x[C](g.fallback),l+=u,p-=u):w.invalid.push({p:p,v:h,e:g.pattern}),p+=u):(e||x[C](H),h===H?(i.push(p),p+=u):(s=H,i.push(p+E),E++),l+=u)}return e=j.charAt(F),A!==B+1||r.translation[e]||x.push(e),x=x.join(""),w.mapMaskdigitPositions(x,i,B),x},mapMaskdigitPositions:function(b,c,a){for(b=q.reverse?b.length-a:0,w.maskDigitPosMap={},a=0;a<c.length;a++)w.maskDigitPosMap[c[a]+b]=1},callbacks:function(a){var b=w.val(),e=b!==g,f=[b,a,d,q],h=function(b,c,a){"function"==typeof q[b]&&c&&q[b].apply(this,a)};h("onChange",!0==e,f),h("onKeyPress",!0==e,f),h("onComplete",b.length===j.length,f),h("onInvalid",0<w.invalid.length,[b,a,d,w.invalid,q])}};d=b(d);var f,r=this,g=w.val();j="function"==typeof j?j(w.val(),void 0,d,q):j,r.mask=j,r.options=q,r.remove=function(){var a=w.getCaret();return r.options.placeholder&&d.removeAttr("placeholder"),d.data("mask-maxlength")&&d.removeAttr("maxlength"),w.destroyEvents(),w.val(r.getCleanVal()),w.setCaret(a),d},r.getCleanVal=function(){return w.getMasked(!0)},r.getMaskedVal=function(a){return w.getMasked(!1,a)},r.init=function(a){if(a=a||!1,q=q||{},r.clearIfNotMatch=b.jMaskGlobals.clearIfNotMatch,r.byPassKeys=b.jMaskGlobals.byPassKeys,r.translation=b.extend({},b.jMaskGlobals.translation,q.translation),r=b.extend(!0,{},r,q),f=w.getRegexMask(),a)w.events(),w.val(w.getMasked());else{q.placeholder&&d.attr("placeholder",q.placeholder),d.data("mask")&&d.attr("autocomplete","off"),a=0;for(var e,g=!0;a<j.length;a++)if(e=r.translation[j.charAt(a)],e&&e.recursive){g=!1;break}g&&d.attr("maxlength",j.length).data("mask-maxlength",!0),w.destroyEvents(),w.events(),a=w.getCaret(),w.val(w.getMasked()),w.setCaret(a)}},r.init(!d.is("input"))};b.maskWatchers={};var d=function(){var d=b(this),e={},f=d.attr("data-mask");if(d.attr("data-mask-reverse")&&(e.reverse=!0),d.attr("data-mask-clearifnotmatch")&&(e.clearIfNotMatch=!0),"true"===d.attr("data-mask-selectonfocus")&&(e.selectOnFocus=!0),a(d,f,e))return d.data("mask",new c(this,f,e))},a=function(c,d,f){f=f||{};var g=b(c).data("mask"),h=JSON.stringify;c=b(c).val()||b(c).text();try{return"function"==typeof d&&(d=d(c)),"object"!=typeof g||h(g.options)!==h(f)||g.mask!==d}catch(a){}},e=function(b){var c=document.createElement("div"),a=((b="on"+b)in c);return a||(c.setAttribute(b,"return;"),a="function"==typeof c[b]),a};b.fn.mask=function(d,e){e=e||{};var f=this.selector,g=b.jMaskGlobals,h=g.watchInterval;g=e.watchInputs||g.watchInputs;var j=function(){if(a(this,d,e))return b(this).data("mask",new c(this,d,e))};return b(this).each(j),f&&""!==f&&g&&(clearInterval(b.maskWatchers[f]),b.maskWatchers[f]=setInterval(function(){b(document).find(f).each(j)},h)),this},b.fn.masked=function(a){return this.data("mask").getMaskedVal(a)},b.fn.unmask=function(){return clearInterval(b.maskWatchers[this.selector]),delete b.maskWatchers[this.selector],this.each(function(){var c=b(this).data("mask");c&&c.remove().removeData("mask")})},b.fn.cleanVal=function(){return this.data("mask").getCleanVal()},b.applyDataMask=function(c){((c=c||b.jMaskGlobals.maskElements)instanceof b?c:b(c)).filter(b.jMaskGlobals.dataMaskAttr).each(d)},e={maskElements:"input,td,span,div",dataMaskAttr:"*[data-mask]",dataMask:!0,watchInterval:300,watchInputs:!0,keyStrokeCompensation:10,useInput:!/Chrome\/[2-4][0-9]|SamsungBrowser/.test(window.navigator.userAgent)&&e("input"),watchDataMask:!1,byPassKeys:[9,16,17,18,36,37,38,39,40,91],translation:{0:{pattern:/\d/},9:{pattern:/\d/,optional:!0},"#":{pattern:/\d/,recursive:!0},A:{pattern:/[a-zA-Z0-9]/},S:{pattern:/[a-zA-Z]/}}},b.jMaskGlobals=b.jMaskGlobals||{},(e=b.jMaskGlobals=b.extend(!0,{},e,b.jMaskGlobals)).dataMask&&b.applyDataMask(),setInterval(function(){b.jMaskGlobals.watchDataMask&&b.applyDataMask()},e.watchInterval)},c=window.jQuery,d=window.Zepto,"function"==typeof define&&define.amd?define(["jquery"],b):"object"==typeof exports&&"undefined"==typeof Meteor?module.exports=b(require("jquery")):b(c||d)}),document.addEventListener("DOMContentLoaded",function(){var j,q,w;j=jQuery,q={productElement:"product__element",buttonAddToBasket:"product__add-to-cart-button",countryCode:"+38",smartBasketCurrency:"\u20B4",productQuantityWrapper:!1,productPrice:!1,productSize:!1,smartBasketMinArea:"header__basket-min",smartBasketMinIconPath:"/smartbasket/img/shopping-basket-wight.svg",smartBasketMinText:!1,telIsRequired:!0,emailIsRequired:!1,nameIsRequired:!0,localStorageName:"basketItems",yaCounter:{counterID:"",targetID:""}},w={getProducts:function(){return JSON.parse(localStorage.getItem(q.localStorageName))},setProducts:function(a){let b=JSON.stringify(a,"",4);return localStorage.setItem(q.localStorageName,b),!1},deleteProducts:function(b,a){let c=j("<button>").attr({class:"smart-basket__product-delete"}).html("<span class=\"smart-basket__delete-icon\">\xD7</span>");return c.click(function(c){c.preventDefault();let d=j(this).data("sbProductDelete");delete b[d],w.setProducts(b),j(this).parents("."+a.attr("class")).remove(),w.getSmartBasketMinState(b,"updateSmartBasketMin"),w.commonResult(b,"updateCommonResult")}),c},showProducts:function(x){let a=j("<form>").attr({class:"smart-basket__form",method:"POST",id:"smart-basket__form",enctype:"multipart/form-data"}),b=j("<div>").attr({class:"smart-basket__product-item"}),e=j("<div>").attr({class:"smart-basket__product-id"}).text("ID"),f=j("<div>").attr({class:"smart-basket__product-name"}).text("\u0422\u043E\u0432\u0430\u0440"),g=j("<div>").attr({class:"smart-basket__product-quantity smart-basket__product-quantity_header"}).text("\u041A\u043E\u043B-\u0432\u043E"),h=j("<span>").attr({class:"smart-basket__info-icon"}).text("?"),c=j("<button>").attr({class:"smart-basket__info-msgs-close"}).text("\xD7"),i=j("<span>").attr({class:"smart-basket__info-msgs"}).html("\u0426\u0435\u043D\u0430 \u0437\u0430 1 \u0442\u043E\u0432\u0430\u0440 \u0438\u043B\u0438 \u0443\u0441\u043B\u0443\u0433\u0443").append(c),d=j("<div>").attr({class:"smart-basket__product-price"}).html(`Цена / ${q.smartBasketCurrency}`).append(h).append(i);h.click(()=>{i.fadeToggle()}),c.click(a=>{a.preventDefault(),i.fadeToggle()});let l=j("<div>").attr({class:"smart-basket__product-price-common"}).html(`Общая цена / ${q.smartBasketCurrency}`),m=j("<div>").attr({class:"smart-basket__product-delete"}).text("\u0423\u0434\u0430\u043B\u0438\u0442\u044C");for(let i in i.append(f).append(e).append(d).append(g).append(l).append(m),a.append(i),x){let e=j("<div>").attr({class:"smart-basket__product-item"}),n=j("<div>").attr({class:"smart-basket__product-id"}),o=j("<input>").attr({class:"smart-basket__input",type:"hidden"}),l=j("<div>").attr({class:"smart-basket__product-name"}),c=j("<input>").attr({class:"smart-basket__input",type:"hidden"}),p=j("<input>").attr({class:"smart-basket__input",type:"hidden"}),d=j("<input>").attr({class:"smart-basket__input",type:"hidden"}),r=j("<div>").attr({class:"smart-basket__product-quantity"}),m=j("<input>").attr({class:"smart-basket__input",type:"hidden"}),k=j("<button>").attr({class:"smart-basket__add-item"}).text("+"),b=j("<button>").attr({class:"smart-basket__remove-item"}).text("-"),f=j("<input>").attr({class:"smart-basket__product-quantity-state",type:"number",min:"1",step:"1",pattern:"^[0-9]"});q.productQuantityWrapper||(k.attr({disabled:"disabled"}),b.attr({disabled:"disabled"}),f.attr({disabled:"disabled"})),r.append(b).append(f).append(k);let s=j("<div>").attr({class:"smart-basket__product-price"}),t=j("<input>").attr({class:"smart-basket__input",type:"hidden"}),h=j("<div>").attr({class:"smart-basket__product-price-common"}),g=j("<input>").attr({class:"smart-basket__input"}),u=w.deleteProducts(x,e);for(let h in x[i]){if("sbId"==h&&(n.html(x[i][h]),o.val(x[i][h]),c.attr({name:x[i][h]+"[productName]"}),p.attr({name:x[i][h]+"[productSize]"}),o.attr({name:x[i][h]+"[productId]"}),m.attr({name:x[i][h]+"[productQuantity]"}),f.attr({"data-sb-id":x[i][h]}),k.attr({"data-sb-id":x[i][h]}),b.attr({"data-sb-id":x[i][h]}),t.attr({name:x[i][h]+"[productPrice]"}),g.attr({name:x[i][h]+"[productPriceCommon]"}),d.attr({name:x[i][h]+"[productImg]"}),u.attr({"data-sb-product-delete":x[i][h]})),"sbImg"==h){let a=j("<img>").attr({src:x[i][h],width:60});d.val(x[i][h]),l.append(a)}if("sbName"==h&&(l.append(`<span>${x[i][h]}</span>`),c.val(x[i][h])),"sbSize"==h&&void 0!==x[i][h]&&(l.children("span").append(`<span class="smart-basket__product-size"> Размер: ${x[i][h]}</span>`),p.val(x[i][h])),"sbPrice"==h&&(s.html(x[i][h]),t.val(x[i][h])),"sbPriceCommon"==h){let a=+x[i][h];g.val(+a.toFixed(2))}"sbQuantity"==h&&(f.val(x[i][h]),m.val(x[i][h]))}b.click(function(b){b.preventDefault();let a=j(this).data("sbId"),c=+f.val(),d=+t.val(),e=d*c;1<c&&(e=d*--c,m.val(c),w.updateBasket(x,a,c,e),w.getSmartBasketMinState(x,"updateSmartBasketMin"),w.commonResult(x,"updateCommonResult")),t.val(d),g.val(+e.toFixed(2)),f.val(c)}),k.click(function(b){b.preventDefault();let a=j(this).data("sbId"),c=+f.val(),d=+t.val(),e=d*c;1<=c?(e=d*++c,m.val(c),w.updateBasket(x,a,c,e),w.getSmartBasketMinState(x,"updateSmartBasketMin"),w.commonResult(x,"updateCommonResult")):c=1,t.val(d),g.val(+e.toFixed(2)),f.val(c)}),n.append(o),l.append(d),l.append(c),l.append(p),r.append(m),s.append(t),h.append(g),a.append(e.append(l).append(n).append(s).append(r).append(h).append(u))}return a.append(w.commonResult(x)),a.append(w.userForm()),a},stateBasket:function(){let a,b,d,f,e=w.getProducts()||{},g=j("<div>").attr({class:"smart-basket"}),h=j("."+q.buttonAddToBasket);if(localStorage.getItem(q.localStorageName),g.append(w.showProducts(e)),q.productQuantityWrapper){const c=j("<div>").attr({class:"smart-basket__quantity-item"});let e=j("<button>").attr({class:"smart-basket__add-item"}).html("+"),g=j("<button>").attr({class:"smart-basket__remove-item"}).html("-");a=j("<input>").attr({class:"smart-basket__product-quantity-state",min:"1",step:"1",pattern:"^[0-9]",value:"1"}),c.append(g).append(a).append(e),e.click(function(c){c.preventDefault(),b=j(this).parents("."+q.productElement).find("."+a.attr("class")),d=j(this).parents("."+q.productElement).find("."+q.buttonAddToBasket),1<=(f=+j(this).parents("."+q.productElement).find("."+a.attr("class")).val())?(f++,b.val(f),d.attr("data-sb-product-quantity",f)):(b.val(1),d.attr("data-sb-product-quantity",1))}),g.click(function(c){c.preventDefault(),b=j(this).parents("."+q.productElement).find("."+a.attr("class")),d=j(this).parents("."+q.productElement).find("."+q.buttonAddToBasket),1<(f=+j(this).parents("."+q.productElement).find("."+a.attr("class")).val())?(f--,b.val(f),d.attr("data-sb-product-quantity",f)):(b.val(1),d.attr("data-sb-product-quantity",1))}),j("."+q.productQuantityWrapper).append(c)}if(q.productSize&&q.productPrice){let a=j("."+q.productSize);j("."+q.productElement).find("."+q.productSize+":first-child").addClass(q.productSize+"_active"),a.click(function(a){a.preventDefault(),j(this).parents("."+q.productElement).find("."+q.productSize).removeClass(q.productSize+"_active"),j(this).addClass(q.productSize+"_active");let b=j(this).parents("."+q.productElement).find("."+q.buttonAddToBasket),c=j(this).parents("."+q.productElement).find("."+q.productPrice),d=j(this).attr("data-sb-curent-size");console.log(d);let e=j(this).attr("data-sb-curent-price"),f=j(this).attr("data-sb-curent-id-or-vendor-code");console.log(f),b.attr({"data-sb-product-price":e,"data-sb-product-size":d,"data-sb-id-or-vendor-code":f}),c.html(e)})}else console.log("\u0417\u0430\u043F\u043E\u043B\u043D\u0438\u0442\u0435 \u043F\u0430\u0440\u0430\u043C\u0435\u0442\u0440\u044B productSize \u0438 productPrice");return w.getSmartBasketMinState(e),h.click(function(){let b=w.getProducts()||{},c=j(this).attr("data-sb-id-or-vendor-code");if(void 0!==b[c]){let b=j(this).html();return j(this).text("\u0422\u043E\u0432\u0430\u0440 \u0443\u0436\u0435 \u0432 \u043A\u043E\u0440\u0437\u0438\u043D\u0435"),j("body").append(w.alertBlock("alreadyAdded")),setTimeout(()=>{j(this).html(b)},1500),!1}{let d={};d.sbId=c,d.sbImg=j(this).data("sbProductImg"),d.sbName=j(this).data("sbProductName"),q.productSize&&q.productPrice&&(d.sbSize=j(this).attr("data-sb-product-size")),d.sbQuantity=q.productQuantityWrapper?j(this).parents("."+q.productElement).find("."+a.attr("class")).val():+j(this).data("sbProductQuantity"),d.sbPrice=+j(this).attr("data-sb-product-price"),d.sbPrice.toFixed(2),q.productQuantityWrapper?(d.sbPriceCommon=+j(this).attr("data-sb-product-price")*j(this).parents("."+q.productElement).find("."+a.attr("class")).val(),d.sbPriceCommon.toFixed(2)):(d.sbPriceCommon=+j(this).attr("data-sb-product-price")*+j(this).data("sbProductQuantity"),d.sbPriceCommon.toFixed(2)),b[c]=d,w.setProducts(b),g.empty(),g.append(w.showProducts(b)),w.getSmartBasketMinState(b,"updateSmartBasketMin"),w.commonResult(b,"updateCommonResult"),j("body").append(w.alertBlock("inBasket"))}}),g},commonResult:function(b,a,e){let f=0,g=0,h=j("<div>").attr({class:"smart-basket__empty-title"}).text("\u041A\u043E\u0440\u0437\u0438\u043D\u0430 \u043F\u0443\u0441\u0442\u0430. \u0412\u044B \u043D\u0435 \u0434\u043E\u0431\u0430\u0432\u0438\u043B\u0438 \u043D\u0438 \u043E\u0434\u043D\u043E\u0433\u043E \u0442\u043E\u0432\u0430\u0440\u0430").fadeOut(),k=j("<div>").attr({class:"smart-basket__success-title"}).text("\u0417\u0430\u043A\u0430\u0437 \u043F\u0440\u0438\u043D\u044F\u0442. \u041E\u0436\u0438\u0434\u0430\u0439\u0442\u0435 \u0437\u0432\u043E\u043D\u043A\u0430").css("display","none"),l=j("<div>").attr({class:"smart-basket__result-common"}),c=j("<div>").attr({class:"smart-basket__price-common"}),m=j("<div>").attr({class:"smart-basket__quantity-common"});for(let c in b)for(let d in b[c])"sbQuantity"==d&&(f+=+b[c][d]),"sbPriceCommon"==d&&(g+=+b[c][d]);if(0==+f?h.fadeIn():h.fadeOut(),e)j("."+k.attr("class")).css("display","block"),setTimeout(()=>{j("."+k.attr("class")).css("display","none"),j("."+h.attr("class")).css("display","block")},3e3);else{if(!a)return m.html(`<span>Всего товаров: </span> ${f}`),c.html(`<span>Общая стоимость: </span> <input name="finalPrice" class="smart-basket__total-cost" type="text" value="${g.toFixed(2)} ${q.smartBasketCurrency}">`),l.append(h).append(k).append(m).append(c),l;0==+f&&j("."+h.attr("class")).css("display","block"),j("."+m.attr("class")).html("<span>\u0412\u0441\u0435\u0433\u043E \u0442\u043E\u0432\u0430\u0440\u043E\u0432: </span> "),j("."+m.attr("class")).html(`<span>Всего товаров: </span> ${f}`),j("."+c.attr("class")).html("<span>\u041E\u0431\u0449\u0430\u044F \u0441\u0442\u043E\u0438\u043C\u043E\u0441\u0442\u044C: </span> "),j("."+c.attr("class")).html(`<span>Общая стоимость: </span> <input name="finalPrice" class="smart-basket__total-cost" type="text" value="${g.toFixed(2)} ${q.smartBasketCurrency}">`)}},getSmartBasketMinState:function(b,a){let c=0;for(let d in b)for(let e in b[d])"sbQuantity"==e&&(c+=+b[d][e]);let d=j("<button>").attr({class:"smart-basket__min"});q.smartBasketMinText&&d.prepend(`<span class="smart-basket__min-text">${q.smartBasketMinText}</span> `);let e=j("<img>").attr({class:"smart-basket__min-icon",src:q.smartBasketMinIconPath,width:18,alt:"\u041A\u043E\u0440\u0437\u0438\u043D\u0430"}),f=j("<span>").attr({class:"smart-basket__min-count"});a?(j("."+f.attr("class")).html(""),j("."+f.attr("class")).html(c)):(f.html(c),j("."+q.smartBasketMinArea).append(d.append(e).append(f))),w.getModalBasket(d,b)},updateBasket:function(b,c,d,e){let f=0,g=0;for(let h in b){if(h===c){let f=0,g={};for(let c in b[h])g.sbId=b[h].sbId,g.sbImg=b[h].sbImg,g.sbName=b[h].sbName,g.sbSize=b[h].sbSize,g.sbPrice=b[h].sbPrice,"sbPriceCommon"==c&&(g.sbPriceCommon=e.toFixed(2)),"sbQuantity"==c&&(g.sbQuantity=d,f+=d);b[c]=g,w.setProducts(b)}for(let c in b[h])"sbQuantity"==c&&(f+=b[h][c]),"sbPriceCommon"==c&&(g+=+b[h][c])}},userForm:function(){let a=j("<div>").attr({class:"smart-basket__user-form"}),e=j("<div>").attr({class:"smart-basket__user-info"}),f=j("<div>").attr({class:"smart-basket__input-wrapper"}),g=j("<input>").attr({class:"smart-basket__user-input",type:"text",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0438\u043C\u044F",name:"userName",required:!0});f.append(g);let h=j("<div>").attr({class:"smart-basket__input-wrapper"}),i=j("<input>").attr({class:"smart-basket__user-input",type:"tel",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0442\u0435\u043B\u0435\u0444\u043E\u043D",name:"userTel",required:q.telIsRequired}).mask(q.countryCode+"(000)000-00-00");h.append(i);let l=j("<div>").attr({class:"smart-basket__input-wrapper"}),c=j("<input>").attr({class:"smart-basket__user-input",type:"email",placeholder:"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 e-mail",name:"userEmail",required:q.emailIsRequired});if(l.append(c),q.agreement.isRequired){var n=j("<div>").attr({class:"smart-basket__agreement-wrapper"});let a=j("<label>").attr({class:"smart-basket__label-agreement",for:"smart-basket__input-agreement"}),b=j("<input>").attr({type:"checkbox",name:"agreement",class:"smart-basket__input-agreement",id:"smart-basket__input-agreement",checked:q.agreement.isChecked,value:"\u042F \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C\u0441\u043A\u043E\u0433\u043E \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"}),c=null;c=q.agreement.isLink?j("<a>").attr({class:"smart-basket__link-agreement",href:q.agreement.isLink,target:"_blank",rel:"nofollow"}):j("<span>").attr({class:"smart-basket__link-agreement"}),b.is(":checked")?c.text("\u042F \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C\u0441\u043A\u043E\u0433\u043E \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"):c.text("\u042F \u043D\u0435 \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C\u0441\u043A\u043E\u0433\u043E \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"),a.click(function(){b.is(":checked")?(c.text("\u042F \u043D\u0435 \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C\u0441\u043A\u043E\u0433\u043E \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"),b.val("\u042F \u043D\u0435 \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C\u0441\u043A\u043E\u0433\u043E \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"),o.attr({disabled:"disabled"}),n.addClass("smart-basket__input-wrapper_error")):(c.text("\u042F \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C\u0441\u043A\u043E\u0433\u043E \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"),b.val("\u042F \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u044E \u0443\u0441\u043B\u043E\u0432\u0438\u044F \u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C\u0441\u043A\u043E\u0433\u043E \u0441\u043E\u0433\u043B\u0430\u0448\u0435\u043D\u0438\u044F"),o.attr({disabled:!1}),n.removeClass("smart-basket__input-wrapper_error"))}),n.append(b).append(a).append(c)}let d=j("<button>").attr({class:"smart-basket__close-form"}).text("\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u043F\u043E\u043A\u0443\u043F\u043A\u0438");w.closeModalBasket(d);let o=j("<button>").attr({class:"smart-basket__send-form",form:"smart-basket__form",type:"submit"}).text("\u0421\u0434\u0435\u043B\u0430\u0442\u044C \u0437\u0430\u043A\u0430\u0437"),m=j("<div>").attr({class:"smart-basket__footer"});e.append(f).append(h).append(l),q.agreement.isChecked&&e.append(n),m.append(d).append(o),a.append(e).append(m),o.click(function(a){function b(b){for(let c in b)return!1;return!0}a.preventDefault();let d=w.getProducts()||{};if(q.nameIsRequired&&q.telIsRequired&&q.emailIsRequired){if(""===i.val()||""===g.val()||""===c.val()||b(d))return""===i.val()&&i.parent().addClass("smart-basket__input-wrapper_error"),""===g.val()&&g.parent().addClass("smart-basket__input-wrapper_error"),""===c.val()&&c.parent().addClass("smart-basket__input-wrapper_error"),!1;w.sendCart()}else if(q.telIsRequired||q.emailIsRequired){if(""===g.val()||!(""!==i.val()&&q.telIsRequired||""!==c.val()&&q.emailIsRequired)||b(d))return""===i.val()&&q.telIsRequired&&i.parent().addClass("smart-basket__input-wrapper_error"),""===c.val()&&q.emailIsRequired&&c.parent().addClass("smart-basket__input-wrapper_error"),""===g.val()&&g.parent().addClass("smart-basket__input-wrapper_error"),!1;w.sendCart()}});let k=b=>{b.focus(function(){j(this).parent().addClass("smart-basket__input-wrapper_focus")}),b.blur(function(){j(this).parent().removeClass("smart-basket__input-wrapper_focus"),""===this.value&&j(this).parent().addClass("smart-basket__input-wrapper_error")}),b.parent().on("input",function(){j(this).removeClass("smart-basket__input-wrapper_error")}),b.change(function(){j(this).parent().removeClass("smart-basket__input-wrapper_error"),j(this).parent().addClass("smart-basket__input-wrapper_focus")})};return k(g),q.telIsRequired&&k(i),q.emailIsRequired&&k(c),a},getModalBasket:function(b,a){w.commonResult(a,"updateCommonResult"),b.click(b=>{b.preventDefault(),j(".smart-basket").toggleClass("smart-basket_active"),j("body").css("overflow","hidden")})},closeModalBasket(b){b.click(b=>{b.preventDefault(),j(".smart-basket").toggleClass("smart-basket_active"),j("body").css("overflow","auto")})},sendCart:function(){let a=j("#smart-basket__form")[0],b=new FormData(a);j.ajax({url:"/smartbasket/php/smartbasket.php",type:"POST",data:b,processData:!1,contentType:!1,beforeSend:function(){},success:function(){},complete:function(){j(".smart-basket__product-item:not(:first)").remove();let a=w.getProducts()||{};w.commonResult(a,"","submitEvent"),localStorage.clear(),""!==q.yaCounter.counterID&&""!==q.yaCounter.targetID&&ym(q.yaCounter.counterID,"reachGoal",q.yaCounter.targetID),setTimeout(()=>{j(".smart-basket").toggleClass("smart-basket_active"),j("body").css("overflow","auto")},3e3),setTimeout(()=>{a=w.getProducts()||{},w.commonResult(a,"updateCommonResult"),w.getSmartBasketMinState(a,"updateSmartBasketMin"),w.showProducts(a)},4e3)}})},alertBlock:function(b){let a=j("<div>").attr({class:"smart-basket__alert-wrapper"}),d=j("<div>").attr({class:"smart-basket__alert"}),e=j("<div>").attr({class:"smart-basket__alert-icon"}),f=j("<div>").attr({class:"smart-basket__alert-text"}),g=j("<div>").attr({class:"smart-basket__alert-footer"}),h=j("<button>").attr({class:"smart-basket__alert-button smart-basket__alert-button_close"}).text("\u041F\u0440\u043E\u0434\u043E\u043B\u0436\u0438\u0442\u044C \u043F\u043E\u043A\u0443\u043F\u043A\u0438"),i=j("<button>").attr({class:"smart-basket__alert-button smart-basket__alert-button_by"}).text("\u0412 \u043A\u043E\u0440\u0437\u0438\u043D\u0443");h.click(function(){j(this).parents("."+a.attr("class")).remove()}),i.click(function(){j(this).parents("."+a.attr("class")).remove()});let c=w.getProducts()||{};return w.getModalBasket(i,c),"inBasket"===b&&(e.html("\n\t\t\t\t<svg class=\"\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 130.2 130.2\">\n         <circle class=\"path circle\" fill=\"none\" stroke=\"#73AF55\" stroke-width=\"6\" stroke-miterlimit=\"10\" cx=\"65.1\" cy=\"65.1\" r=\"62.1\"/>\n         <polyline class=\"path check\" fill=\"none\" stroke=\"#73AF55\" stroke-width=\"6\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" points=\"100.2,40.2 51.5,88.8 29.8,67.5 \"/>\n\t\t\t\t</svg>"),f.text("\u0422\u043E\u0432\u0430\u0440 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D \u0432 \u043A\u043E\u0440\u0437\u0438\u043D\u0443")),"alreadyAdded"===b&&(e.html("\n\t\t\t\t<svg version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 130.2 130.2\">\n          <circle class=\"path circle\" fill=\"none\" stroke=\"#D06079\" stroke-width=\"6\" stroke-miterlimit=\"10\" cx=\"65.1\" cy=\"65.1\" r=\"62.1\"/>\n          <line class=\"path line\" fill=\"none\" stroke=\"#D06079\" stroke-width=\"6\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" x1=\"34.4\" y1=\"37.9\" x2=\"95.8\" y2=\"92.3\"/>\n          <line class=\"path line\" fill=\"none\" stroke=\"#D06079\" stroke-width=\"6\" stroke-linecap=\"round\" stroke-miterlimit=\"10\" x1=\"95.8\" y1=\"38\" x2=\"34.4\" y2=\"92.2\"/>\n\t\t\t\t</svg>\n\t\t\t\t"),f.append("\u0422\u043E\u0432\u0430\u0440 \u0443\u0436\u0435 \u0434\u043E\u0431\u0430\u0432\u043B\u0435\u043D \u0432 \u043A\u043E\u0440\u0437\u0438\u043D\u0443")),g.append(h).append(i),a.append(d.append(e).append(f).append(g)),a},init:function(a){return j.extend(q,a),this.each(function(){j(this).append(w.stateBasket())})}},j.fn.smbasket=function(b){return w[b]?w[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void j.error("\u041C\u0435\u0442\u043E\u0434 "+b+" \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D"):w.init.apply(this,arguments)}});
